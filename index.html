<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>English Text Checker</title>

<script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f5f6fa;
    padding:40px;
    max-width:1000px;
    margin:auto;
}
h1{margin-bottom:10px;}
#dropZone{
    border:2px dashed #888;
    padding:30px;
    text-align:center;
    margin-bottom:20px;
    background:white;
    cursor:pointer;
}
textarea{
    width:100%;
    height:200px;
    padding:10px;
    margin-bottom:15px;
}
button{
    padding:10px 15px;
    margin-right:10px;
    cursor:pointer;
}
#output{
    margin-top:20px;
    background:white;
    padding:20px;
    border-radius:5px;
    min-height:150px;
    white-space:pre-wrap;
}
.error{
    background:#ffcccc;
    color:#b30000;
}
.suggestion{
    background:#ccffcc;
    color:#006600;
}
</style>
</head>
<body>

<h1>English Text Checker</h1>

<div id="dropZone">
    Drag & Drop (.txt, .docx) here or click to upload
    <input type="file" id="fileInput" hidden>
</div>

<textarea id="textInput" placeholder="...or paste your text here"></textarea>

<button onclick="checkText()">Check English</button>
<button onclick="applyFixes()">Apply Fixes</button>
<button onclick="downloadText()">Download Corrected Text</button>

<div id="output"></div>

<script>
let correctedText = "";

const dropZone = document.getElementById("dropZone");
const fileInput = document.getElementById("fileInput");

dropZone.addEventListener("click", () => fileInput.click());

dropZone.addEventListener("dragover", e=>{
    e.preventDefault();
    dropZone.style.background="#eef";
});
dropZone.addEventListener("dragleave", ()=>{
    dropZone.style.background="white";
});
dropZone.addEventListener("drop", e=>{
    e.preventDefault();
    dropZone.style.background="white";
    handleFile(e.dataTransfer.files[0]);
});

fileInput.addEventListener("change", ()=>{
    handleFile(fileInput.files[0]);
});

function handleFile(file){
    const reader = new FileReader();

    if(file.name.endsWith(".txt")){
        reader.onload = e=>{
            document.getElementById("textInput").value = e.target.result;
        };
        reader.readAsText(file);
    }

    else if(file.name.endsWith(".docx")){
        reader.onload = function(event) {
            mammoth.extractRawText({arrayBuffer: event.target.result})
                .then(result=>{
                    document.getElementById("textInput").value = result.value;
                });
        };
        reader.readAsArrayBuffer(file);
    }

    else{
        alert("Unsupported format in demo version.");
    }
}

function checkText(){
    const text = document.getElementById("textInput").value;
    let output = text;

    // Simple demo rules
    const rules = [
        {wrong:"teh", correct:"the"},
        {wrong:"recieve", correct:"receive"},
        {wrong:"dont", correct:"don't"},
        {wrong:"im", correct:"I'm"}
    ];

    rules.forEach(rule=>{
        const regex = new RegExp("\\b"+rule.wrong+"\\b","gi");
        output = output.replace(regex, 
            `<span class="error">${rule.wrong}</span>
             <span class="suggestion">(${rule.correct})</span>`
        );
    });

    correctedText = text;
    rules.forEach(rule=>{
        const regex = new RegExp("\\b"+rule.wrong+"\\b","gi");
        correctedText = correctedText.replace(regex, rule.correct);
    });

    document.getElementById("output").innerHTML = output;
}

function applyFixes(){
    document.getElementById("textInput").value = correctedText;
    document.getElementById("output").innerText = correctedText;
}

function downloadText(){
    const blob = new Blob([correctedText], {type:"text/plain"});
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "corrected_text.txt";
    link.click();
}
</script>

</body>
</html>
